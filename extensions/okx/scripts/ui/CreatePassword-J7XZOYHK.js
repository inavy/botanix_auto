import{b as he}from"./chunk-V6BOP5NP.js";import{a as Ee}from"./chunk-5IZQ5YDG.js";import{d as ge}from"./chunk-HQU64EZU.js";import{a as W,b as _e}from"./chunk-V22Z2X6F.js";import{a as we}from"./chunk-JLHU3WBU.js";import{b as X,c as ee,d as oe,e as te,f as re,g as se,l as ae,m as ne,n as ie,o as me}from"./chunk-K77FV23O.js";import"./chunk-B4VYECZS.js";import"./chunk-67Z572PX.js";import{a as de,b as ue}from"./chunk-O2BGLKEM.js";import{L as B}from"./chunk-NPTEYWCZ.js";import"./chunk-Y57SQLFF.js";import"./chunk-C6D3UGMF.js";import{a as fe}from"./chunk-NZ4SV4UK.js";import"./chunk-YFSBCNC7.js";import{l as z,m as Z,n as j,o as q}from"./chunk-OFUXQTAD.js";import{a as ce}from"./chunk-NRCRSATA.js";import"./chunk-NZHMCNZN.js";import{F as G,Sa as J,a as S,ga as Q}from"./chunk-4HJMB7P7.js";import"./chunk-A2W6OJDL.js";import"./chunk-U7RD3Z4E.js";import"./chunk-CJVER5MJ.js";import"./chunk-S5IEFQ34.js";import{o as He}from"./chunk-XHNZXPBB.js";import{ac as pe,qb as le}from"./chunk-ZTS7374H.js";import"./chunk-QXE433GW.js";import{ca as H,da as Ue,ta as V,ya as De}from"./chunk-EY7FXYAJ.js";import{d as $,f as ve}from"./chunk-B26CCOB3.js";import"./chunk-QYHQY2ME.js";import"./chunk-FT7VATMT.js";import{a as Be}from"./chunk-YYAHGUV5.js";import"./chunk-7ZE3XWQE.js";import"./chunk-42AETIVN.js";import"./chunk-DKCCIZ3Q.js";import"./chunk-HBMVMNWX.js";import{Fc as Y,Lc as Ke,fc as K,lc as xe,o as D,y as Me}from"./chunk-IS2B3ORW.js";import"./chunk-YGSCKFAL.js";import{D as f,H as v,q as y}from"./chunk-TDPA2BUG.js";import{F,pa as Fe}from"./chunk-BJO2AFCW.js";import{M as We,w as n}from"./chunk-OIAB2YVD.js";import"./chunk-QHMZGTYF.js";import"./chunk-X5EUMZZI.js";import"./chunk-PJSODKKF.js";import{ca as E}from"./chunk-VXVCGVBA.js";import"./chunk-G6JM4G2M.js";import{a as U}from"./chunk-DAL2TMJA.js";import"./chunk-IEDGM2AY.js";import"./chunk-DAX5D55P.js";import"./chunk-UAZMAR7J.js";import"./chunk-BQF3XODK.js";import"./chunk-I5RKKMWZ.js";import"./chunk-4LMFSJNF.js";import"./chunk-IH7OWVTK.js";import"./chunk-RF2WJL7B.js";import"./chunk-OTDALOBJ.js";import"./chunk-JCKY6H7C.js";import"./chunk-6AWMYHRK.js";import"./chunk-5VBNU5MN.js";import{f as w,m as _,o as g}from"./chunk-JEQEC2HU.js";_();g();var t=w(U()),N=w(pe()),k=w(He());Fe();We();ve();_();g();var h=w(U()),L=w(pe()),Ae=w(Be());Ue();function Pe(){let c=(0,L.useDispatch)(),i=(0,Ae.useHistory)(),u=(0,L.useSelector)(le),[d,T]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{u&&!d&&(c(H(!1)),i.push(S))},[u,d,i,c]),(0,h.useCallback)(()=>{T(!0)},[])}xe();_();g();var ye=c=>{let{onboardingTabs:i}=c.metamask;if(!i||Object.keys(i).length!==1)return null;let u=Object.keys(i)[0],d=i[u];return{location:u,tabId:d}};Me();Ke();De();var p={SEED:"seed",KEY:"key",HARDWARE:"hardware",CREATE:"create",MPC:"mpc",BULK:"bulk"},Po=({history:c})=>{let i=we(),u=f.useForm(),[d,{set:T}]=(0,k.useBoolean)(!1),[m,Te]=(0,t.useState)({}),r=(0,N.useDispatch)(),{seedPhrase:I,privateKey:A,mpcInfo:be,unlockHardwareWallets:b,chooseNetworkList:M,isTonMnemonic:Ce}=(0,N.useSelector)(e=>({seedPhrase:X(e),privateKey:ee(e),mpcInfo:te(e),unlockHardwareWallets:oe(e),chooseNetworkList:re(e),onboardingInitiator:ye(e),isTonMnemonic:se(e)})),Re=Pe(),x=i.get("from"),Se=x===p.HARDWARE,C=x===p.BULK,{setValue:Le}=ge(),P=async(e,l)=>{try{r(he(!0)).then(async()=>{if(Re(),await r(fe()),e===p.CREATE){c.push({pathname:Q,search:`?type=${Y.INITIALIZE}`});return}let s=`${G}/${e}`,{keyringName:a="",walletName:o=""}=l||{},R=`${a}-${o}`;if(e===p.HARDWARE&&K()===D){globalThis.platform.openExtensionInPopup(`${s}?anim=1`);return}c.push({pathname:s,state:{walletName:R,anim:"1",next:S}})}).catch(console.log)}catch(s){console.error(s.message)}},O=t.default.useMemo(()=>{let{password:e,confirmPassword:l}=m;return!(e?.length>=de&&e===l)},[d,A,I,b,m]),Ne=(0,k.useMemoizedFn)(async()=>{if(!(d||O)){T(!0),B();try{if(I){let o=await r(Z(m.password,I?.trim().toLowerCase().match(/\w+/gu)?.join(" ")||"",{isTonMnemonic:Ce}));P(p.SEED,o),r(ae())}if(A){let o=await r(j(m.password,M,A));P(p.KEY,o),r(ne())}if(C){Le(m.password),c.push(J);return}let{cipherText:e,privateKey:l,mpcId:s,userInfo:a}=be;if(e&&l&&s){let o=await r(q(m.password,{cipherText:e,privateKey:l},{mpcId:s,userInfo:a},!0));P(p.MPC,o),r(me())}if(!F(b)){await $().setPassword(m.password);let o=await r(Ee(b));P(p.HARDWARE,o),r(ie())}if(!I&&!A&&!(e&&l&&s)&&F(b)){let o=await r(z(m.password));P(p.CREATE,o)}}catch(e){e.message===V&&v.error(n("wallet_home_toast_network_error"))}finally{T(!1)}}},[O,m,I,A,M]);(0,t.useEffect)(()=>{if(C){let e=document.querySelector("#app");e&&(e.classList.remove("fullscreen"),e.classList.add("popup"))}return()=>{if(C){let e=document.querySelector("#app");e&&(e.classList.remove("popup"),e.classList.add("fullscreen"))}}},[]);let ke=C?{position:"absolute",bottom:0,left:0}:{};return t.default.createElement(_e,{title:n("wallet_signup_maintitle_set_password"),desc:n(Se?"wallet_extension_signup_subtitle_set_password_hardware":"wallet_extension_subtitle_password_unlock")},({formClass:e,formErrorClass:l,itemClass:s})=>t.default.createElement(f,{form:u,size:E.SIZE.lg,onSubmit:Ne,validateTrigger:["onChange"],className:e,errorClassName:l,onValuesChange:(a,o)=>{Te(o)}},t.default.createElement(f.Item,{name:"password",style:{marginBottom:0},className:s,label:n("wallet_set_password_subtitle_password")},t.default.createElement(y.Password,{autoFocus:!0,autoComplete:"off",inputClassName:W.passwordInput,size:y.SIZE.xl,placeholder:n("wallet_settings_reset_passord_placeholder_input_desc")})),t.default.createElement(f.Item,{noStyle:!0,shouldUpdate:(a,o)=>a.password!==o.password},({getFieldValue:a})=>{let o=a("password");return t.default.createElement(ue,{password:o})}),t.default.createElement(f.Item,{name:"confirmPassword",style:{flex:1,marginTop:"32px"},dependencies:["password"],className:s,rules:[({getFieldValue:a})=>({validator:(o,R)=>{let Oe=a("password");return R&&Oe!==R?Promise.reject(n("wallet_set_password_errortip_password_not_match")):Promise.resolve()}})],label:n("wallet_set_password_subtitle_confirm_password")},t.default.createElement(y.Password,{autoComplete:"off",inputClassName:W.passwordInput,size:y.SIZE.xl,placeholder:n("wallet_settings_reset_passord_placeholder_input_desc")})),t.default.createElement(ce.FooterActions,{affixStyle:ke},t.default.createElement(f.Item,{noStyle:!0},t.default.createElement(E,{block:!0,htmlType:"submit",disabled:O,size:E.SIZE.lg,type:E.TYPE.highlight,loading:d,category:E.CATEGORY.fill},n("wallet_set_password_btn_confirm"))))))};export{Po as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=CreatePassword-J7XZOYHK.js.map
