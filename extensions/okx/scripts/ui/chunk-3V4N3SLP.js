import{e as S}from"./chunk-75JFJJ6E.js";import{e as z}from"./chunk-XEXJRJUY.js";import{aa as Y,ba as j,e as F,g as D,h as G,i as W,k as H,l as U,m as K,n as Z,o as R,p as oe}from"./chunk-NPTEYWCZ.js";import{a as se}from"./chunk-Y57SQLFF.js";import{q as k}from"./chunk-U7RD3Z4E.js";import{Z as O,aa as N,b as f}from"./chunk-QYHQY2ME.js";import{c as g}from"./chunk-HBMVMNWX.js";import{F as $,a as y,f as h,pa as V}from"./chunk-BJO2AFCW.js";import{M as te,l as T,w as s}from"./chunk-OIAB2YVD.js";import{T as ne,c as me,ca as B}from"./chunk-VXVCGVBA.js";import{a as ee}from"./chunk-DAL2TMJA.js";import{f as L,m as p,o as x}from"./chunk-JEQEC2HU.js";p();x();var A=L(ee());V();te();p();x();var re={extLink:"_extLink_f58rv_1"};var I=({link:e,monitorEvt:t=h})=>{let n=()=>{t({is_click_risk_link:!0}),globalThis.platform.openTab({url:e?.scamsUrl})};return A.default.createElement("span",{className:re.extLink,onClick:n},s("wallet_extension_function_link_case"))},pe=()=>{let e=se(),t=(u,b)=>({title:s("wallet_extension_header_title_transaction_risk"),desc:s(u,{case:A.default.createElement(I,{link:e,monitorEvt:b})}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")}),n=(u="")=>({screenOne:{title:s("wallet_extension_function_title_approve_to_eoa"),desc:s("wallet_extension_function_desc_approve_to_eoa",{address:z(u),link:A.default.createElement(I,{link:e,monitorEvt:F})}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")},screenTwo:{title:s("wallet_extension_function_title_approve_to_eoa"),desc:s("wallet_extension_function_desc_developer_continue"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_function_btn_continue_transaction")},monitorEvt:F}),o=()=>({screenOne:t("wallet_extension_mid_desc_transaction_account_risk",W),screenTwo:{title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_mid_desc_continue_transaction"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_mid_btn_continue_transaction")},monitorEvt:W}),a=()=>({screenOne:t("wallet_extension_mid_desc_transaction_account_risk",G),monitorEvt:G}),r={title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_function_desc_developer_continue"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_function_btn_continue_transaction")};return{getEoaModalParams:n,getEthSignModalParams:()=>({screenOne:t("wallet_extension_sign_card_desc_risky_blocked",D),monitorEvt:D}),getLowerValueModalParams:()=>({screenOne:t("wallet_extension_sign_card_desc_risky_unusual",Y),screenTwo:r,monitorEvt:Y}),getSolPermissionsModalParams:a,getTronPermissionsModalParams:o,getBlackAddressWarnModalParams:(u="")=>({screenOne:{title:s("wallet_extension_header_title_transaction_risk"),desc:u,mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")},screenTwo:r,monitorEvt:oe}),getStrongBlackAddressModalParams:(u="")=>({screenOne:{title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_address_card_desc_risky_blocked",{address:z(u),case:A.default.createElement(I,{link:e,monitorEvt:R})}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")},monitorEvt:R}),getSuspicionWithdrawAddressModalParams:()=>({screenOne:t("wallet_extension_mid_desc_transaction_address_risk",j),screenTwo:r,monitorEvt:j}),getNotSameParamsModalParams:()=>({screenOne:t("wallet_extension_warning_tampered_blocking",H),monitorEvt:H}),getRiskRejectParamsModalParams:()=>({screenOne:t("wallet_extension_warning_risky_blocking",K),monitorEvt:K}),getRiskAlertParamsModalParams:()=>({screenOne:t("wallet_extension_warning_risky_doublecheck",U),screenTwo:r,monitorEvt:U}),getMaliciousTokenModalParams:()=>({screenOne:t("wallet_extension_warning_risky_doublecheck_token",Z),monitorEvt:Z}),getConnectRiskModalParams:u=>({screenOne:{title:s("wallet_extension_tg_risk_alert_title_link"),desc:s("wallet_extension_tg_risk_alert_desc_link",{host:u,case:A.default.createElement(I,{link:e})}),mainBtnText:s("wallet_extension_tg_risk_alert_btn_link")}})}},Ve=pe;p();x();var _=L(ee()),J=L(me());V();p();x();var d={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var ae=e=>{let{children:t,desc:n,title:o,isPureScreen:a}=e;return _.default.createElement(g.FlexBox,{className:d.main,direction:g.DIRECTION.vertical},_.default.createElement(g.Box,{className:(0,J.default)(d.box,{[d.isPureScreen]:a})},_.default.createElement(g.Box,{className:d.tipImg},_.default.createElement(ne,{className:(0,J.default)("okx-wallet-plugin-risk-trading",d.tipImgIcon)})),_.default.createElement(k.Text,{className:d.title,align:k.ALIGN.center},o),_.default.createElement(k.Text,{className:d.decs,size:k.SIZE.sm,align:k.ALIGN.center},n)),_.default.createElement(g.Box,{className:d.footerWrap},t))},xe=({modalParams:e,handleCancel:t,handleNext:n})=>{let{screenOne:o,screenTwo:a,monitorEvt:r=h}=e,[c,l]=(0,_.useState)(!1),i=async()=>{r({is_click_cancel_link:!0}),l(!0),await t(),l(!1)},m=async()=>{r({is_click_advanced_link:!0}),n()};return _.default.createElement(ae,{desc:o.desc,title:o.title},_.default.createElement(g.Box,{className:d.screenOneButtons},_.default.createElement(B,{block:!0,loading:c,size:B.SIZE.lg,onClick:i,type:B.TYPE.highlight,category:B.CATEGORY.fill},o.mainBtnText),a?_.default.createElement(g.Box,{className:d.extButton,onClick:m},o.subBtnText):null))},fe=({handleCancel:e,handleNext:t,modalParams:n})=>{let{screenTwo:o={},monitorEvt:a=h}=n,r=[{actionType:S.ACTION_TYPE.CANCEL,btnText:o.subBtnText,onClick:()=>{a({is_click_advanced_continue_link:!0}),t()}},{actionType:S.ACTION_TYPE.CONFIRM,btnText:o.mainBtnText,onClick:()=>{a({is_click_advanced_cancel_link:!0}),e()}}];return _.default.createElement(ae,{isPureScreen:!0,desc:o.desc,title:o.title},_.default.createElement(g.Box,{className:d.screenTwoButtons},_.default.createElement(S,{buttonGroup:r})))},ge=({handleCancel:e,closeModal:t,modalParams:n})=>{let[o,a]=(0,_.useState)(1);return o===2?_.default.createElement(fe,{modalParams:n,handleCancel:e,handleNext:t}):_.default.createElement(xe,{modalParams:n,handleCancel:e,handleNext:()=>{a(2)}})},Qe=ge;p();x();V();te();var w={NATIVE:132,TOKEN:99,NFT:66,OTHERS:33},P={add:"+",sub:"-"},Te="306001",we=e=>{let{approveList:t=[],assetChange:n=[]}=e||{};if(t.length){let o=t[0];if([f.AUTHORIZATION,f.CANCEL_AUTHORIZATION,f.INCREASE_ALLOWANCE,f.DECREASE_ALLOWANCE,f.COMMON_APPROVE,f.NFT_AUTHORIZATION,f.NFT_CANCEL_AUTHORIZATION].includes(o?.approvalType))return o.approvalType}return n.length?f.TRANS_OUT:""},ie=(e,t)=>{let n=e.filter(({operator:r})=>r===P.sub),o=e.filter(({operator:r})=>r===P.add),a=(r,c)=>{let l=r[t],i=c[t],m=r.asset?.decimals,E=c.asset?.decimals;return m&&E&&(l=T.div(l,T.pow(10,m)),i=T.div(i,T.pow(10,E))),T.sub(i,l)};return n.sort(a),o.sort(a),[...n,...o]},Ee=(e,t)=>{let n=e.assetsDiffs?.[t]||{},o=e.exposures?.[t]||[],a=e.permissions?.[t]||[],r=e.permissionMsg||"",c=e.intention||{},l=e.blackAddressWarning||{},i=e.causeRiskItem||[];return{assetsDiff:n,exposure:o,permission:a,permissionMsg:r,intention:c,blackAddress:l,causeRiskItem:i}},ke=e=>{let t=[];return y(e)&&e.forEach(n=>{let{asset:o}=n||{};if(n?.diff){let a=T.gt(n.diff,0);t.push({asset:o,usdValue:n.diffUsdValue,operator:a?P.add:P.sub,rawValue:a?n.diff:n.diff?.slice(1)})}else n?.out?.forEach(a=>{t.push({asset:o,operator:P.sub,...a})}),n?.in?.forEach(a=>{t.push({asset:o,operator:P.add,...a})})}),t},Ae=(e,t)=>{if(!e||$(e))return{};let{assetsDiff:n,exposure:o,permission:a,permissionMsg:r,intention:c,blackAddress:l,causeRiskItem:i}=Ee(e,t),m=[];if(y(o)){let u=o[0]||{},{asset:b={},spenders:M={}}=u;Object.entries(M).forEach(([ue,de])=>{m.push({asset:b,address:ue,...de})})}let E=ke(n),C={};[w.NATIVE,w.TOKEN,w.OTHERS].forEach(u=>{let b=E.filter(M=>M?.asset?.assetType===u);C[u]=ie(b,"rawValue")});let X=E.filter(u=>u?.asset?.assetType===w.NFT),q=ie(X,"tokenNum"),Q=[...C[w.NATIVE],...C[w.TOKEN],...q,...C[w.OTHERS]];return{intention:c,permission:a,permissionMsg:r,assetChange:Q,approveList:m,blackAddress:l,causeRiskItem:i}},le=e=>e&&e?.result===!1,ce=e=>e&&(e?.resultCode===Te||e?.addFundsFlag),Pe=e=>le(e)&&!ce(e),rt=(e,t,n={})=>{let{from:o,preExecuteFailed:a=!1}=n||{},r={};return t?.forEach(c=>{let l=e?.find(i=>i?.checkType===c)||{};if(c===O.SAFE_ADDRESS){let i=Boolean(l?.blackAddress),m=l?.isSimilar||N.FAILED;r[c]={...l,isDefraud:i,similarType:m,isSimilar:[N.EXACT,N.ROUGH].includes(m)}}else if(c===O.CONTRACT_ADDRESS)r[c]={...l,isContract:typeof l?.result=="boolean"&&!l?.result};else if(c===O.KYS){let i=Ae(l,o);r[c]={...i,txType:we(i)}}else if(c===O.VERIFY_GAS_LIMIT){let i={...l};a&&(i.result=!1),r[c]={...i,isPreExecuteFailed:le(i),isPreExecuteGasError:ce(i),isPreExecuteNonGasError:Pe(i)}}else r[c]=l}),r};export{Ve as a,Qe as b,w as c,P as d,Te as e,le as f,ce as g,Pe as h,rt as i};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-3V4N3SLP.js.map
