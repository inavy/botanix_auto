import{h as go,k as Co}from"./chunk-AMZN2EAS.js";import{a as Re,b as vo,c as To,d as ho}from"./chunk-4FRWD727.js";import{a as yo,b as xo}from"./chunk-7WAPJBDH.js";import{d as uo,e as _o}from"./chunk-GE7QYBP5.js";import{a as Be}from"./chunk-WJYVGS4V.js";import{a as fo}from"./chunk-CSJR56CD.js";import{a as oo,b as Se,d as no,e as lo,g as mo,i as co,k as po,m as Te}from"./chunk-5D7TO4KC.js";import{b as to}from"./chunk-G5K5AHVE.js";import{e as eo}from"./chunk-T4SJQSS7.js";import{a as wo}from"./chunk-ZBRU2CAM.js";import{a as so}from"./chunk-MIZXVXK6.js";import{c as Ke,e as $t}from"./chunk-GNBB55K5.js";import{a as Xe,b as io,c as ro}from"./chunk-GANFA4Y3.js";import{a as Xt,e as $e}from"./chunk-75JFJJ6E.js";import{h as ao}from"./chunk-WOF2MG5G.js";import{b as Kt}from"./chunk-6QV7GAE5.js";import{c as Rt}from"./chunk-QT2MBFKK.js";import{d as ve}from"./chunk-MUF5KFVU.js";import{b as Jt}from"./chunk-SSZF4QIS.js";import{a as zt}from"./chunk-XEXJRJUY.js";import{a as Le,d as Mt}from"./chunk-BPSSG62G.js";import{a as Ut,b as Yt}from"./chunk-ZDO7TFIW.js";import{a as Zt,d as qt}from"./chunk-OLBL2ESK.js";import{h as jt}from"./chunk-WFHUBXJH.js";import{ha as Ct,w as gt}from"./chunk-NPTEYWCZ.js";import{c as Qt}from"./chunk-SF4X4VPT.js";import{a as Vt}from"./chunk-NRCRSATA.js";import{b as le}from"./chunk-A2W6OJDL.js";import{f as Dt,h as Je,l as Ot,m as Ht,q as O}from"./chunk-U7RD3Z4E.js";import{o as xe}from"./chunk-XHNZXPBB.js";import{Ba as kt,G as It,J as Pt,Oa as Lt,Sa as St,Ta as je,ac as _n,yb as Bt}from"./chunk-ZTS7374H.js";import{g as Wt}from"./chunk-XJYCT5UP.js";import{C as At,U as Q,Z as ke,b as Pe,d as Et,k as Nt}from"./chunk-QYHQY2ME.js";import{a as U}from"./chunk-QJGSL63Z.js";import{d as Gt}from"./chunk-7ZE3XWQE.js";import{c as g}from"./chunk-HBMVMNWX.js";import{Db as Ze,Eb as ct,Fb as Ve,Gb as Ae,Ib as pt,Kb as ye,Lc as pn,Qc as bt,Sb as ut,V as mt,Vc as un,Wc as Ft,Xa as mn,Xc as dn,cc as Ie,ic as dt,lc as cn,xc as wt}from"./chunk-IS2B3ORW.js";import{A as vt,G as Tt,H as ht,b as ft,d as yt,o as X,q as Qe,r as xt}from"./chunk-TDPA2BUG.js";import{K as Ue,e as st,pa as lt}from"./chunk-BJO2AFCW.js";import{M as ne,l as V,v as Ye,w as i}from"./chunk-OIAB2YVD.js";import{T as _t,c as qe,ca as A}from"./chunk-VXVCGVBA.js";import{a as Z}from"./chunk-DAL2TMJA.js";import{f as I,m as r,o as s}from"./chunk-JEQEC2HU.js";r();s();r();s();ne();r();s();var Ce=I(Z());r();s();r();s();var j=I(Z()),bo=I(_n());ne();Ie();r();s();var R={title:"_title_1xthp_1",subtitle:"_subtitle_1xthp_9",fee:"_fee_1xthp_15",feeTitle:"_feeTitle_1xthp_21",feeDetail:"_feeDetail_1xthp_26",speedDetail:"_speedDetail_1xthp_33",gasDetail:"_gasDetail_1xthp_36"};var fn=()=>{let e=Kt(),t=ao(),o=jt(),a=(0,bo.useSelector)(Bt),n=to(),_=uo(),l=async(m,y,d,w=0)=>{let{baseCoin:T}=await e(d,!0),b=o?.[T.coinId]||"0",F=Ze(m,y),E=Ht(Ve(F,w),{symbol:T.symbol,decimals:T.decimals}),x=Ot(Ze(ct(Ve(F,w),10**T.decimals),b),{symbol:a.symbol});return`${E} ${x}`},u=(m,y)=>{let d=n(m);return i("wallet_extension_transaction_confirmation_gas_detail",{gasPrice:V.thousandFormat(d),gasLimit:V.thousandFormat(y)})},c=async(m,y)=>{try{return await _({...m,coinId:y})}catch{return""}},p=({userGasInfo:m,updateGasInfo:y,fetchParams:d})=>{let{gasPrice:w,maxFeePerGas:T,maxPriorityFeePerGas:b}=y,{supportEip1559:F,gasLimit:E,gasPrice:x,maxFeePerGas:h,maxPriorityFeePerGas:M}=m;return F?(delete d.gasPrice,{...d,value:d?.amount,maxFeePerGas:T||h,maxPriorityFeePerGas:b||M,gasLimit:E}):{...d,value:d?.amount,gasPrice:w||x,gasLimit:E}};return async({coinId:m,baseCoinAmountUse:y,userGasInfo:d,updateGasInfo:w,serverSignInfo:T,fetchParams:b})=>{let{gasPrice:F,maxFeePerGas:E}=w,{supportEip1559:x,gasLimit:h,gasPrice:M,maxFeePerGas:P}=d,B=0;T?.needExtFee&&(B=await c(p({userGasInfo:d,updateGasInfo:w,fetchParams:b}),m));let D=x?P:M,z=await l(D,h,m),H=u(D,h),q=x?E:F,W=await l(q,h,m,B),J=u(q,h);return new Promise((Y,K)=>{let re=X.prompt({hideCloseBtn:!1,alignBottom:!1,titleCenter:!1,infoType:null,confirmText:i("extension_toast_btn_confirmgasfee"),confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},onConfirm:async()=>{re.destroy();let{baseCoin:te}=await e(m,!0),{coinAmountInt:$}=t(te.coinId),ae=Ae($,y);po({userGasInfo:d,updateGasInfo:w,baseCoinAmountAvailable:ae,L1FEE:B})?(Tt.error({title:i("extension_toast_text_insufficient_balance")}),K(new Error(Te))):Y(w)},onClose:()=>{re.destroy(),K(new Error(Te))},renderContent:te=>j.default.createElement(te,null,j.default.createElement("div",{className:R.title},i("extension_toast_title_transaction_replace")),j.default.createElement("div",{className:R.subtitle},i("extension_toast_subtitle_gasincrease")),j.default.createElement("div",{className:R.feeTitle},i("extension_toast_title_current_transaction")),j.default.createElement("div",{className:R.fee},j.default.createElement("div",{className:R.feeDetail},z),j.default.createElement("div",{className:R.gasDetail},H)),j.default.createElement("div",{className:R.feeTitle},i("extension_toast_title_gasprice")),j.default.createElement("div",{className:R.fee},j.default.createElement("div",{className:R.speedDetail},W),j.default.createElement("div",{className:R.gasDetail},J)))})})}},Fo=fn;var yn=()=>{let e=Fo();return async({coinId:o,baseCoinAmountUse:a,userGasInfo:n,serverGasInfo:_,serverSignInfo:l,originTxGasInfo:u,fetchParams:c})=>{let p=co({userGasInfo:n,serverGasInfo:_,originTxGasInfo:u});return p?.gasPrice||p?.maxFeePerGas?(await e({coinId:o,baseCoinAmountUse:a,userGasInfo:n,updateGasInfo:p,serverSignInfo:l,fetchParams:c}),Promise.resolve(p)):Promise.resolve()}},Eo=yn;r();s();var Ge={content:"_content_18w99_1",title:"_title_18w99_4",text:"_text_18w99_10"};var xn=()=>{let e=Eo();return async({coinId:o,baseCoinAmountUse:a="0",showSelectNonceDialog:n=!1,onChainNonce:_="0",newNonce:l="0",userGasInfo:u={},serverGasInfo:c={},serverSignInfo:p={},originTxGasInfo:f={},fetchParams:m={},title:y="",text:d="",confirmText:w="",cancelText:T=""})=>new Promise((b,F)=>{if(n){let E=X.prompt({hideCloseBtn:!0,alignBottom:!1,titleCenter:!1,infoType:null,cancelBtnProps:{category:A.CATEGORY.outline,size:A.SIZE.lg},confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},confirmText:w,cancelText:T,onConfirm:async()=>{E.destroy();try{let x=await e({coinId:o,baseCoinAmountUse:a,userGasInfo:u,serverGasInfo:c,serverSignInfo:p,originTxGasInfo:f,fetchParams:m});b(x?{nonce:_,updateGasInfo:x}:{nonce:_})}catch(x){F(x)}},onCancel:()=>{E.destroy(),b({nonce:l})},renderContent:x=>Ce.default.createElement(x,null,Ce.default.createElement("div",{className:Ge.content},Ce.default.createElement("div",{className:Ge.title},y),Ce.default.createElement("div",{className:Ge.text},d)))})}else b({nonce:l})})},Me=xn;var vn=()=>{let e=Me();return async({coinId:o,baseCoinAmountUse:a,hasFailedTx:n,onChainNonce:_,newNonce:l,userGasInfo:u,serverGasInfo:c,originTxGasInfo:p,serverSignInfo:f,fetchParams:m})=>e({coinId:o,baseCoinAmountUse:a,showSelectNonceDialog:n,onChainNonce:_,newNonce:l,userGasInfo:u,serverGasInfo:c,serverSignInfo:f,originTxGasInfo:p,fetchParams:m,title:i("wallet_extension_transaction_popup_failed_transaction"),text:i("wallet_extension_transaction_popup_replace_failed_transaction"),confirmText:i("wallet_extension_transaction_popup_btn_replace"),cancelText:i("wallet_extension_transaction_popup_btn_skip")})},No=vn;r();s();ne();var Tn=()=>{let e=Me();return async({coinId:o,baseCoinAmountUse:a,hasPendingTx:n,onChainNonce:_,newNonce:l,userGasInfo:u,serverGasInfo:c,originTxGasInfo:p,serverSignInfo:f,fetchParams:m})=>e({coinId:o,baseCoinAmountUse:a,showSelectNonceDialog:n,onChainNonce:_,newNonce:l,userGasInfo:u,serverGasInfo:c,serverSignInfo:f,fetchParams:m,originTxGasInfo:p,title:i("wallet_extension_transaction_popup_pending_transaction"),text:i("wallet_extension_transaction_popup_replace_pending_transaction"),confirmText:i("wallet_extension_transaction_popup_btn_replace"),cancelText:i("wallet_extension_transaction_popup_btn_continue_wait")})},Ao=Tn;r();s();ne();lt();var hn=()=>async({isRepeat:t,onCancel:o})=>new Promise((a,n)=>{if(t){let _=X.prompt({alignBottom:!1,hideCloseBtn:!0,infoType:X.Prompt.INFO_TYPE.warn,confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},cancelBtnProps:{category:A.CATEGORY.outline,size:A.SIZE.lg},title:i("wallet_extension_popup_repeat_order"),confirmText:i("wallet_extension_popup_repeat_order_btn_continue"),cancelText:o?i("wallet_extension_popup_repeat_order_btn_viewhistory"):null,text:i("wallet_extension_popup_repeat_order_desc"),onConfirm:()=>{_.destroy(),a()},onCancel:()=>{_.destroy(),st(o)&&o(),n(new Error(Te))}})}else a()}),Io=hn;var Po="FetchError";var ko=()=>{let e=No(),t=Ao(),o=Io(),a=async({coinId:l,from:u,to:c,amount:p,gasPrice:f})=>{let[{data:m=[]},{data:y={}}]=await Promise.all([Pt({checkTypes:[ke.REPEAT,ke.OVERWRITTEN],coinId:l,from:u,to:c,amount:p,gasPrice:f}),It({coinId:l,address:u},{fromAddr:u,scenario:Nt.SCENARIO_SEND_COIN})]);return{txToastCheckData:m,signInfoData:y}},n=l=>{let{hasFailedTx:u,hasPendingTx:c,nonce:p,newNonce:f,originGasPrice:m,originPriorityFee:y}=mo(l),d=lo(l,ke.REPEAT);return{hasFailedTx:u,hasPendingTx:c,nonce:p,newNonce:f,originGasPrice:m,originPriorityFee:y,isRepeat:d}};return async({coinId:l,from:u,to:c,amount:p,gasPrice:f,baseCoinAmountUse:m,userGasInfo:y,whetherCheckRepeat:d,onRepeatCancel:w})=>{let T=[],b={};try{let W=await a({coinId:l,from:u,to:c,amount:p,gasPrice:f});if(!Array.isArray(W.txToastCheckData)||typeof W.signInfoData!="object")throw new Error(Po);T=W.txToastCheckData,b=W.signInfoData?.info||{}}catch{throw new Error(Po)}let F=n(T),{nonce:E,newNonce:x,originGasPrice:h,originPriorityFee:M,hasFailedTx:P,hasPendingTx:B,isRepeat:D}=F,z={originGasPrice:h,originPriorityFee:M},H={coinId:l,baseCoinAmountUse:m,onChainNonce:E,newNonce:x,userGasInfo:y,serverGasInfo:b.gasPrice,serverSignInfo:b,originTxGasInfo:z,fetchParams:{amount:p,coinId:l,from:u,gasPrice:f,to:c}},q={nonce:x};return P?q=await e({...H,hasFailedTx:P}):B&&(q=await t({...H,hasPendingTx:B})),d&&await o({isRepeat:D,onCancel:w}),q}};r();s();var Ho=I(Z());r();s();var v=I(Z()),we=I(xe()),et=I(qe());ne();r();s();var ee=I(Z()),Lo=I(xe());r();s();var L={"mev-control-enter":"_mev-control-enter_1h6im_1",mevControlEnter:"_mev-control-enter_1h6im_1","mev-control-content":"_mev-control-content_1h6im_6",mevControlContent:"_mev-control-content_1h6im_6","mev-control-content-title":"_mev-control-content-title_1h6im_9",mevControlContentTitle:"_mev-control-content-title_1h6im_9","mev-control-content-desc":"_mev-control-content-desc_1h6im_14",mevControlContentDesc:"_mev-control-content-desc_1h6im_14","list-content":"_list-content_1h6im_18",listContent:"_list-content_1h6im_18","list-item":"_list-item_1h6im_21",listItem:"_list-item_1h6im_21","item-icon":"_item-icon_1h6im_24",itemIcon:"_item-icon_1h6im_24","list-item-text":"_list-item-text_1h6im_28",listItemText:"_list-item-text_1h6im_28","mev-control-title":"_mev-control-title_1h6im_32",mevControlTitle:"_mev-control-title_1h6im_32","mev-control-sub-title":"_mev-control-sub-title_1h6im_37",mevControlSubTitle:"_mev-control-sub-title_1h6im_37","mev-control-picture":"_mev-control-picture_1h6im_42",mevControlPicture:"_mev-control-picture_1h6im_42","mev-control-divider":"_mev-control-divider_1h6im_46",mevControlDivider:"_mev-control-divider_1h6im_46","mev-control-text-content":"_mev-control-text-content_1h6im_50",mevControlTextContent:"_mev-control-text-content_1h6im_50","mev-status":"_mev-status_1h6im_54",mevStatus:"_mev-status_1h6im_54","mev-status__text":"_mev-status__text_1h6im_58",mevStatusText:"_mev-status__text_1h6im_58","mev-status__text__active":"_mev-status__text__active_1h6im_63",mevStatusTextActive:"_mev-status__text__active_1h6im_63","mev-tooltip":"_mev-tooltip_1h6im_66",mevTooltip:"_mev-tooltip_1h6im_66"};var gn=({mevList:e,mevChecked:t,setMevChecked:o,...a})=>{let n=(0,ee.useRef)(null),_=(0,Lo.useSize)(n),l=c=>{o(c)},u=c=>ee.default.createElement(Zt,{icon:{size:le.SIZE.lg,src:c.vendorIcon||Gt,type:le.TYPE.image},className:L["list-item"],onClick:()=>{l(c)},...a},ee.default.createElement(g.FlexBox,{direction:g.DIRECTION.vertical},ee.default.createElement(g.FlexBox,{align:g.ALIGN.center},ee.default.createElement(O.Text,{className:L["list-item-text"]},c.name))),c.name===t.name&&ee.default.createElement(g.FlexBox,{className:L["item-icon"],justify:"flex-end"},ee.default.createElement(le,{icon:"okds-success-circle-fill",size:le.SIZE.sm})));return e.length?ee.default.createElement("div",{ref:n,className:L["list-content"]},ee.default.createElement(qt,{itemKey:"id",height:_?.height??408,searchable:!1,dataSource:e,renderItem:u})):null},So=gn;var Bo="mevOperated",Cn=2e3,wn=({isMev:e,needTooltip:t=!0,isShowBlockSwapMevTooltip:o,onMevChange:a,mevChecked:n,mevList:_,setMevChecked:l,className:u="",children:c})=>{let[p,{setFalse:f,setTrue:m}]=(0,we.useBoolean)(!1),[y,{toggle:d}]=(0,we.useBoolean)(!1),[w,T]=(0,v.useState)(""),[b]=(0,v.useState)(e);(0,v.useEffect)(()=>{let h=!e&&o,M=!e&&Ye.get(Bo)===void 0,P=()=>{f()},B=()=>{Ye.set(Bo,1)};return h?(T("wallet_extension_trade_tooltip_enable_mev"),m(),document.addEventListener("click",P,!1)):M&&(T("wallet_extension_mev_pop_turnon_mev"),m(),document.addEventListener("click",P,!1),document.addEventListener("click",B,!1)),()=>{document.removeEventListener("click",P,!1),document.removeEventListener("click",B,!1)}},[]);let F=()=>{window.localStorage.setItem("mevCheckedName",n.name)};(0,v.useEffect)(()=>{b&&n&&(F(),a(b,n))},[b,n]);let E=(0,we.useMemoizedFn)(()=>{typeof a=="function"&&(F(),a(!e,n)),Ct({mev:!e}),T(e?"wallet_extension_mev_pop_mev_off":"wallet_extension_mev_pop_mev_on"),d(),m(),setTimeout(()=>{f()},Cn)}),x=Wt({dark:"/cdn/assets/imgs/245/127CAD27DF691613.png",light:"/cdn/assets/imgs/2311/700F36AE20EC394E.png"});return n?v.default.createElement(v.default.Fragment,null,v.default.createElement("div",{className:(0,et.default)(L["mev-status"],u),onClick:d},v.default.createElement(Dt,{show:p,title:t&&i(w),placement:vt.DIRECTION.bottomRight},c||v.default.createElement(io,{clickable:!0,title:i("wallet_extension_mev_subtitle_protection")},v.default.createElement(O.Text,{className:(0,et.default)(L["mev-status__text"],{[L["mev-status__text__active"]]:e})},i(e?"wallet_extension_mev_desc_open":"wallet_extension_mev_desc_closed"))))),v.default.createElement(X.Action,{visible:y,onClose:d,onCancel:d,title:v.default.createElement(v.default.Fragment,null),isFull:!0,noContentPadding:!0,noMargin:!0,onConfirm:E,confirmBtnProps:e?{size:A.SIZE.lg,type:A.TYPE.primary,category:A.CATEGORY.outline}:{size:A.SIZE.lg,type:A.TYPE.highlight,category:A.CATEGORY.fill},confirmText:e?i("wallet_extension_mev_btn_disable_mev"):i("wallet_extension_mev_btn_activate_protection")},v.default.createElement(g.Box,{className:L["mev-control-content"]},v.default.createElement(g.FlexBox,{justify:"space-between",align:g.ALIGN.center},v.default.createElement(g.Space,{direction:g.DIRECTION.vertical,space:12},v.default.createElement(O.Text,{className:L["mev-control-title"]},i("wallet_extension_mev_grouptitle_mev_protection")),v.default.createElement(O.Text,{style:{color:e?"var(--okd-color-semantic-positive)":"var(--okd-color-content-primary)"},className:L["mev-control-sub-title"]},i(e?"wallet_extension_mev_label_enabled":"wallet_extension_mev_label_disabled"))),v.default.createElement(yt,{className:L["mev-control-picture"],src:x})),v.default.createElement(Je,{className:L["mev-control-divider"],style:{marginTop:24}}),v.default.createElement(g.Space,{className:L["mev-control-text-content"],direction:g.DIRECTION.vertical,space:24},v.default.createElement(g.Box,null,v.default.createElement(O.Text,{className:L["mev-control-content-title"]},i("wallet_extension_mev_title_provider")),v.default.createElement(So,{mevList:_,mevChecked:n,setMevChecked:l})),v.default.createElement(Je,{className:L["mev-control-divider"]}),v.default.createElement(g.Box,null,v.default.createElement(O.Text,{className:L["mev-control-content-title"]},i("wallet_extension_mev_title_mev_attack")),v.default.createElement(O.Text,{className:L["mev-control-content-desc"]},i("wallet_extension_mev_subtitle_mev_attack"))),v.default.createElement(g.Box,null,v.default.createElement(O.Text,{className:L["mev-control-content-title"]},i("wallet_extension_mev_title_prevent_attacks")),v.default.createElement(O.Text,{className:L["mev-control-content-desc"]},i("wallet_extension_mev_subtitle_prevent_attacks"))),v.default.createElement(g.Box,null,v.default.createElement(O.Text,{className:L["mev-control-content-desc"]},i("wallet_extension_mev_subtitle_mev_reset"))))))):null},Go=wn;r();s();r();s();var De=I(Z()),Mo=I(xe());un();dn();var bn=()=>{let[e,{setFalse:t}]=(0,Mo.useBoolean)(!0),[o,a]=(0,De.useState)([]),n=async()=>{try{let _=await bt(Ft.getMevList,{},{});return a(_.data),_.data}catch{return[]}finally{t()}};return(0,De.useEffect)(()=>{n()},[]),[e,o]},Do=bn;var ce=I(Z()),Fn=e=>{let[t,o]=Do(),[a,n]=(0,ce.useState)(""),[_,l]=(0,ce.useState)([]);(0,ce.useEffect)(()=>{let c=o.find(m=>window.localStorage.getItem("mevCheckedName")===m.name&&m.chainIds.includes(Number(e))),p=o.find(m=>m.chainIds.includes(Number(e))),f=o.filter(m=>m.chainIds.includes(Number(e)));l(f),n(c||p)},[o,e]);let u=(0,ce.useMemo)(()=>a&&o.length>0&&!t,[a,o,t]);return[a,_,u,n]},Oo=Fn;var En=({isMev:e,chainId:t,className:o,needTooltip:a,isShowBlockSwapMevTooltip:n,onMevChange:_,children:l})=>{let[u,c,p,f]=Oo(t);return p&&Ho.default.createElement(Go,{isMev:e,needTooltip:a,className:o,isShowBlockSwapMevTooltip:n,onMevChange:_,mevChecked:u,mevList:c,setMevChecked:f},l)},Wo=En;r();s();var G=I(Z()),de=I(xe());lt();ne();r();s();var be=I(Z()),pe=I(qe());ne();r();s();var me={root:"_root_wpiv5_1",title:"_title_wpiv5_4",header:"_header_wpiv5_8",icon:"_icon_wpiv5_12",content:"_content_wpiv5_16",textarea:"_textarea_wpiv5_19",errorTip:"_errorTip_wpiv5_22",errorBordered:"_errorBordered_wpiv5_29"};function Nn({className:e,value:t,onChange:o,error:a,titleClass:n,errorTipClass:_,headerClassName:l,contentClassName:u,...c}){return be.default.createElement(ft,{defaultExpanded:!0,className:(0,pe.default)(me.root,e),titleClass:(0,pe.default)(me.title,n),headerClassName:(0,pe.default)(me.header,l),contentClassName:(0,pe.default)(me.content,u),customHeaderIcon:p=>be.default.createElement(le,{icon:"okds-arrow-chevron-down-md",size:le.SIZE.xs,className:(0,pe.default)({"okui-accordion-header-icon-expanded":p},me.icon)}),title:i("wallet_extension_inscription_text_hex_data_optional")},be.default.createElement(Qe.TextArea,{...c,inputClassName:me.textarea,errorType:Qe.TIP_TYPE.always,error:!!a,value:t,onChange:p=>{let f=p.target.value||"";o?.(f.trim())}}),!!a&&be.default.createElement(O.Text,{className:(0,pe.default)(me.errorTip,_)},a))}var zo=Nn;r();s();ne();function Uo(e){return!!e&&(e.toLowerCase()==="0x"||!Mt(e)||e.length%2!==0)?i("wallet_extension_inscription_text_input_formatting_error"):null}r();s();var Yo=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"unpause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"isPauser",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"paused",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"renouncePauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"account",type:"address"}],name:"addPauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"pause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"decimals",type:"uint8"},{name:"totalSupply",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}];r();s();var C=I(Z()),ue=I(xe()),Vo=I(qe());ne();Ie();r();s();var S={root:"_root_14625_1",icon:"_icon_14625_1",editApproveAmountModal:"_editApproveAmountModal_14625_10",content:"_content_14625_22",txTypeInfo:"_txTypeInfo_14625_25",editArea:"_editArea_14625_28",unlimitedText:"_unlimitedText_14625_33",unlimitedSymbol:"_unlimitedSymbol_14625_42",symbolClassName:"_symbolClassName_14625_59",quickHandler:"_quickHandler_14625_62",balanceWrap:"_balanceWrap_14625_69",balance:"_balance_14625_69",maxBalance:"_maxBalance_14625_91",unlimited:"_unlimited_14625_33",text:"_text_14625_104",authQuantityWarnTip:"_authQuantityWarnTip_14625_111",danger:"_danger_14625_118",info:"_info_14625_121",approveTip:"_approveTip_14625_124",footerActions:"_footerActions_14625_132"};var Zo=V.toPlainString(10**40),An=e=>{typeof e!="string"&&(e=e.toString());let t=e?.length;return t<=9?36:t>=10&&t<12?32:t===12?30:t>=13&&t<=15?24:t>=16&&t<=18?20:t>=19&&t<=24?16:12},qo=({address:e,coins:t,baseCoinId:o})=>{if(Array.isArray(t))return t.find(a=>a?.baseCoinId===o&&zt(a?.address,e,{baseCoinId:o})||qo({address:e,baseCoinId:o,coins:a?.childrenCoin}))},In=({txTypeInfo:e,walletAccount:t,approve:o,baseCoin:a,onAuthTokenAmountChange:n,updateApproveInfo:_})=>{let{walletId:l}=t,{tokenInfo:u,id:c,amount:p,authQuantity:f}=o||{},{autoEdit:m,defaultAmount:y,warnTip:d}=f||{},{address:w,decimals:T,symbol:b}=u,F=ho(b,12),[E,x]=(0,C.useState)(!1),[h,M]=(0,C.useState)(!1),[P,B]=(0,C.useState)(0),D=(0,ue.useMemoizedFn)((k=p)=>{M(je(k)),B(yo(k,T)),x(!0)}),z=(0,C.useMemo)(()=>d?{type:S.info,text:d}:h&&!je(y)?{type:S.danger,text:i("wallet_extension_approve_alert_high_risk_unlimited")}:!h&&V.eq(P||0,0)?{type:S.info,text:i("wallet_extension_approve_cannot_zero")}:null,[d,h,y,P]),{chainId:H}=a||{},{coinId:q}=ve(void 0,void 0,{chainId:H,address:w})||{},W=Be(q,l)?.coinAmount,J=V.thousandFormat(W),Y=(0,ue.useMemoizedFn)(()=>{M(!1),B(W)}),K=(0,C.useMemo)(()=>!(h||V.gt(`${P||0}`,0)),[h,P]),re=(0,ue.useMemoizedFn)(()=>{let k=h?St:xo(P,T);n(k),_(c,{amount:k}),x(!1)}),te=wo(),$=Jt({},l),ae=(0,C.useMemo)(()=>$?.find(k=>k.localType===a?.localType),[a?.localType,$?.length]),ie=(0,ue.useMemoizedFn)(async(k=0)=>{if(!qo({address:w,coins:te,baseCoinId:a?.coinId}))try{let oe=await Ut({contractAddress:w,chainInfo:ae});await Yt(oe)}catch(oe){++k<3?ie(k):ht.error({title:oe?.msg||i("wallet_home_toast_network_error")})}});return(0,ue.useMount)(()=>{m&&D(y),ie()}),C.default.createElement(g.Box,{className:S.root},C.default.createElement(g.Box,{className:S.icon,onClick:()=>{D()}},C.default.createElement(_t,{className:"okx-wallet-plugin-draw-20"})),C.default.createElement(X.Action,{hideCloseBtn:!0,noContentPadding:!0,visible:E},C.default.createElement(g.Box,{className:S.editApproveAmountModal},C.default.createElement(g.Box,{className:S.content},C.default.createElement(go,{bordered:!1,txTypeInfo:e,className:S.txTypeInfo}),C.default.createElement(g.Box,{className:S.editArea},h?C.default.createElement(O.Text,{className:S.unlimitedText},i("wallet_extension_transfer_title_unlimited_amount",{token:C.default.createElement(O.Text,{className:S.unlimitedSymbol},F)})):C.default.createElement(Rt,{symbol:F,autoSize:An,placeholder:"0",max:Zo,decimals:T,value:P,onChange:k=>{pt(k,Zo)&&B(k)},style:{fontWeight:700,height:"42px"},symbolClassName:S.symbolClassName})),C.default.createElement(g.Box,{className:S.quickHandler},!!Number(W)&&C.default.createElement(g.Box,{className:S.balanceWrap},C.default.createElement(O.Text,{className:S.balance,ellipsis:{tooltip:J}},i("wallet_extension_approve_label_balance",{amount:J})),C.default.createElement(g.Box,{className:S.maxBalance,onClick:Y},i("commonall_enterfield_btn_max"))),C.default.createElement(g.Box,{onClick:()=>{M(k=>!k),B(0)},className:S.unlimited},C.default.createElement(g.Box,{className:S.text},i("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")),C.default.createElement(xt,{checked:h}))),!!z&&C.default.createElement(g.Box,{className:(0,Vo.default)(S.authQuantityWarnTip,z.type)},z.text)),C.default.createElement(g.Box,{className:S.approveTip},i("wallet_extension_approve_desc_dapp_right")),C.default.createElement(Vt,{affixStyle:{position:"none"},placeholder:!1,className:S.footerActions},C.default.createElement(A,{block:!0,disabled:K,category:A.CATEGORY.fill,type:A.TYPE.primary,size:A.SIZE.lg,onClick:re},i("wallet_extension_approve_btn_amount_confirmation"))))))},Qo=In;r();s();var Oe=I(Z()),jo=I(xe());pn();mn();var Pn=({coinId:e,txParams:t,networkFee:o,modifiedData:a,mevInfo:n,isMev:_,gasReturnActivity:l})=>({coinId:e,toAddr:t?.to,fromAddr:t?.from,txSource:wt.DAPP,coinAmount:(Le(t?.value)?U(t?.value):t?.value)||0,serviceCharge:o,inputData:a,mev:_?n?.name:"",activityId:l?.activityId}),kn=({mergedParams:e,gasType:t})=>JSON.stringify({to:e?.to,gasType:t,from:e?.from,value:Le(e?.value)?U(e?.value):e?.value,nonce:Le(e?.nonce)?U(e?.nonce):e?.nonce,data:e?.data,gas:e?.gasLimit,oldTxHash:"",gasPrice:e?.supportEip1559?e?.maxFeePerGas:e?.gasPrice,repeatTxType:Et.CONFIRMING,priorityFee:e?.supportEip1559?e.maxPriorityFeePerGas:0}),Ln=({loading:e,isBalanceLoading:t})=>e||t,Sn=({coinId:e,txType:t,txParams:o,isMev:a,mevInfo:n,localType:_,modifiedData:l,walletAccount:u,customGasInfo:c,gasReturnActivity:p,modifiedDataError:f,isSufficientGas:m,isSufficientBalance:y,reportGasReturnActivityDataInConfirm:d,canConfirm:w,silentLoading:T,onCancel:b,onConfirm:F,onConfirmReplace:E,isBalanceLoadError:x,isBalanceLoading:h})=>{let{walletId:M}=u||{},P=ko(),{networkFee:B,gasType:D,gasPrice:z}=c||{},H=_o({coinId:e,walletId:M,localType:_,fromAddr:o?.from}),q=eo(Pn({coinId:e,txParams:o,networkFee:B,modifiedData:l,mevInfo:n,isMev:a,gasReturnActivity:p})),W=(0,Oe.useMemo)(()=>c?.isNetworkFeeLoading||Se(c,t)||x||f||T||w===!1||!m||!y,[T,c,t,f,w,m,y,x]),J=(0,jo.useMemoizedFn)(async()=>{if(E&&typeof F=="function")return F({isMev:a,coinId:e,mevInfo:n,txParams:o,customGasInfo:c,modifiedData:l,gasReturnActivity:p,reportGasReturnActivityDataInConfirm:d});let{nonce:ie,updateGasInfo:k}=await P({to:o?.to,from:o?.from,coinId:e,gasPrice:z,userGasInfo:c,amount:U(o?.value)||0,baseCoinAmountUse:U(o?.value||0)});d();let ge={...o,...c,...k||{},nonce:ie,data:l};try{let oe=await H(ge),Fe=await Xt(mt,oe);return await q(oe,{txHash:Fe,extJson:kn({mergedParams:ge,gasType:D})}),F?.({txHash:Fe})}catch(oe){return F?.({error:oe})}}),{loading:Y,onClick:K}=Xe(J),re=(0,Oe.useMemo)(()=>({disabled:W,loading:Ln({loading:Y,isBalanceLoading:h}),actionType:$e.ACTION_TYPE.CONFIRM,onClick:K}),[W,K,Y,h]),{loading:te,onClick:$}=Xe(b);return[(0,Oe.useMemo)(()=>({loading:te,onClick:$,actionType:$e.ACTION_TYPE.CANCEL}),[te,$]),re]},Jo=Sn;r();s();var He=I(Z());ne();var Bn=e=>{let[t,o]=(0,He.useState)({isNetworkFeeLoading:!0,gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,gasType:Q.STANDARD}),{gasLimitInfo:a={},gasLimit:n,gasPrice:_,maxFeePerGas:l,gasType:u,supportEip1559:c,customConfirmed:p,isGasLimitLoading:f,isNetworkFeeLoading:m,networkFee:y,maxPriorityFeePerGas:d,gasPriceInfo:w,extFee:T}=t,{minGasFee:b}=oo({gasLimit:n,gasPrice:_,maxPriorityFeePerGas:d,maxFeePerGas:l,supportEip1559:c,extFee:T,gasPriceInfo:w,gasLimitInfo:a,gasType:u}),F=(0,He.useMemo)(()=>u===Q.CUSTOM&&!p?i("extension_send_mid_text_dapps_suggested_fee"):u||Q.STANDARD,[p,u]),E=Se(t,e),x=m&&f&&!a?.gasLimit;return{level:F,estimateFailed:E,customGasInfo:t,loading:m,networkFee:x?void 0:b,maxNetworkFee:x?void 0:y,onCustomGasInfoChange:o}},Ko=Bn;r();s();var he=I(Z());cn();Ie();var Gn=({txType:e,walletId:t,coinId:o,txParams:a,customGasInfo:n,preExecuteLoading:_})=>{let[l,u]=(0,he.useState)(""),c=ve(o),{from:p,to:f}=a||{},[m,y]=(0,he.useState)("");(0,he.useEffect)(()=>{_||(Re(e)||vo(e)?(u(Ke.approval),y(Re(e)?"approve":"revoke_approve")):(u(Ke.dapp),y("Contract interaction")))},[_,e]);let d=$t({walletId:t,coinId:o,fromAddress:p,toAddress:f,txType:l,fee:ut(n?.networkFee),disabled:!f,unavailable:n.gasType===Q.CUSTOM&&n.customConfirmed}),{status:w,activity:T,activityId:b,tip:F,clear:E}=d,x=()=>{dt({activityId:b,activity:T,status:w,tip:F,walletId:t,address:p})},h=T?.errorCode;return(0,he.useEffect)(()=>{!m||h===0&&gt({wallet_address:p,interactive_address:f,chain_id:c?.chainId,transaction_type:m})},[h,m,p,f,c?.chainId]),{gasReturnActivity:d,clearGasReturnInfo:E,reportGasReturnActivityDataInConfirm:x}},$o=Gn;r();s();Ie();var Mn=e=>{let{txParams:t={}}=e,{gasPrice:o,maxFeePerGas:a,maxPriorityFeePerGas:n}=t,_=t.gas||t.gasLimit,l=Q.STANDARD,u,c,p,f=U(_),m=U(o),y=U(a),d=U(n);return ye(m,0)&&(l=Q.CUSTOM,u=m),ye(y,0)&&ye(d,0)&&ye(y,d)&&(l=Q.CUSTOM,c=y,p=d),ye(f,0)&&(l=Q.CUSTOM),!t.to&&t.data&&(l=Q.CUSTOM),{initialGasType:l,initialCustomMaxPriorityFee:p,initialCustomGasLimit:f,initialCustomGasPrice:u,initialCustomMaxBaseFee:Ae(c,p)}},Xo=Mn;r();s();var We={"data-input":"_data-input_dry9a_1",dataInput:"_data-input_dry9a_1","data-input-error-tip":"_data-input-error-tip_dry9a_5",dataInputErrorTip:"_data-input-error-tip_dry9a_5","mev-status__wrap":"_mev-status__wrap_dry9a_10",mevStatusWrap:"_mev-status__wrap_dry9a_10"};var Dn=e=>Number(e)===Pe.INCREASE_ALLOWANCE?Yo:[],On=e=>{let{txId:t,chainId:o,walletId:a,txParams:n,dappInfo:_={},needMev:l=!1,openMev:u=!1,coinId:c,isShowBlockSwapMevTooltip:p,onMevChange:f,onConfirm:m,onConfirmReplace:y,onCancel:d}=e||{},[w,T]=(0,de.useSetState)({mevInfo:{},isMev:u}),[b,{toggle:F}]=(0,de.useBoolean)(!1),{from:E,to:x,value:h="0x0",data:M}=n||{},[P,B]=(0,G.useState)(""),D=ve(c,void 0,{chainId:o}),z=D?.coinId,[H,q]=(0,G.useState)({}),W=H.loading,J=(0,G.useMemo)(()=>!x&&M?kt.DEPLOY_CONTRACT:H?.approveInfoList?.[0]?.spender?.approvalType||"",[x,M,H]),Y=Qt(D?.localType,a),K=U(h),re=Xo({txParams:n}),te=fo(Y.walletId),$=(0,G.useMemo)(()=>Uo(P),[P]),{isMev:ae,mevInfo:ie}=w,k=P||M||"",ge=(0,G.useMemo)(()=>({dappData:JSON.stringify({to:x,from:E,value:h,data:k}),from:E,dappInfo:_,chainIndex:D?.chainId,method:At.SIGN_TRANSACTION}),[D?.chainId,E,k,x,h]),oe=(0,de.useMemoizedFn)((se,fe)=>{T({isMev:se,mevInfo:fe}),f?.(se,fe)}),{level:Fe,networkFee:Ro,maxNetworkFee:Ee,customGasInfo:tt,estimateFailed:ot,loading:en,onCustomGasInfoChange:tn}=Ko(J),{gasReturnActivity:nt,reportGasReturnActivityDataInConfirm:on}=$o({txType:J,coinId:z,txParams:n,customGasInfo:tt,preExecuteLoading:W,walletId:Y.walletId}),{coinAmountInt:_e,coinAmount:nn,isBalanceLoadError:at,isBalanceLoading:an,requestBalance:rn}=Be(z,a),it=(0,G.useMemo)(()=>(Ue(_e)||V.gte(_e,Ee))&&H?.needFillUp!==!0,[_e,Ee,H?.needFillUp]),rt=(0,G.useMemo)(()=>!V.eq(K,0)&&!Ue(_e)?V.lte(K,V.sub(_e,Ee)):!0,[_e,Ee,K]),sn=Jo({coinId:z,txType:J,txParams:n,isMev:ae,mevInfo:ie,isBalanceLoadError:at,isBalanceLoading:an,canConfirm:H?.canConfirm,silentLoading:H?.silentLoading,isSufficientGas:it,isSufficientBalance:rt,walletAccount:Y,customGasInfo:tt,gasReturnActivity:nt,modifiedDataError:$,localType:D?.localType,modifiedData:k,walletId:Y?.walletId,reportGasReturnActivityDataInConfirm:on,onCancel:d,onConfirm:m,onConfirmReplace:y}),ln=(0,de.useMemoizedFn)(se=>{let fe=Dn(J),Ne=Lt(n?.data,fe);if(Ne){let ze=To(n?.data,{approveAmount:se},Ne);B(ze)}});return G.default.createElement(G.default.Fragment,null,G.default.createElement(Co,{handleCancel:d,preExecParams:ge,walletAccount:Y,buttonGroup:sn,onUpdatePreExecInfo:q,txState:{txId:t,baseCoin:D,estimateFailed:ot,isSufficientBalance:rt,isSufficientGas:it,baseCoinAmount:nn,isBalanceLoadError:at,requestBalance:rn},slot:{mev:!!l&&G.default.createElement(Wo,{isMev:ae,needTooltip:!1,className:We["mev-status__wrap"],chainId:D?.chainId,onMevChange:oe,isShowBlockSwapMevTooltip:p}),networkFeeEntry:G.default.createElement(so,{level:Fe,coinId:z,networkFee:Ro,loading:en,estimateFailed:ot,onClick:()=>{F(),te({trade:"contract_interaction",all_confirmation:"network_fee"})}}),interactWith:!!x&&G.default.createElement(ro,{address:x,title:i("wallet_extension_popup_text_interact_with")}),advancedEntry:!M&&G.default.createElement(zo,{value:P,error:$,onChange:B,className:We["data-input"],errorTipClass:We["data-input-error-tip"]})},renderEditApproveAmount:(se,fe)=>{let Ne=se?.authQuantity?.canEdit,ze=se?.spender?.approvalType;return[Pe.INCREASE_ALLOWANCE,Pe.AUTHORIZATION].includes(ze)&&Ne?G.default.createElement(Qo,{txTypeInfo:H?.txTypeInfo,walletAccount:Y,approve:se,baseCoin:D,onAuthTokenAmountChange:ln,updateApproveInfo:fe}):null}}),G.default.createElement(no,{visible:b,coinId:z,address:E,inputData:k,tokenAddress:x,value:U(h),onBack:F,onClose:null,initialGasData:re,onGasChange:tn,minimumGasLimit:ae?ie.gas:0,isMev:ae,mevInfo:ie,gasReturn:nt,gasLimitOptions:{disabled:$}}))},Rs=On;export{ko as a,zo as b,Uo as c,Wo as d,Rs as e};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-45MY2MVD.js.map
