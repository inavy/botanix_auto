import{b as c}from"./chunk-6AXFJWFY.js";import{fa as H,ha as O}from"./chunk-ZTS7374H.js";import{na as j,oa as rt}from"./chunk-EY7FXYAJ.js";import{d as E,f as ot}from"./chunk-B26CCOB3.js";import{F as C,Q as y,pa as tt}from"./chunk-BJO2AFCW.js";import{M as et,m as N}from"./chunk-OIAB2YVD.js";import{a as st}from"./chunk-4LMFSJNF.js";import{f as Z,m as a,o as n}from"./chunk-JEQEC2HU.js";a();n();tt();ot();var W="txHistoryRejectValues",at={hideValuelessNft:"hideValuelessNft"},ft={NORMAL:0,RISKY:1,VALUELESS:2},A={[at.hideValuelessNft]:!0},v=async()=>{try{return await E().getSelectedWallet()}catch{return null}},q=()=>{try{let t=localStorage.getItem(W);return t?JSON.parse(t)??{}??{}:{}}catch{return{}}},J=(t={})=>{try{let e=JSON.stringify(t);return localStorage.setItem(W,e),!0}catch{return!1}},gt=async(t,e)=>{try{let r=await v();if(!r)return!1;let o=q(),s={[r]:{[t]:e}};return J(y({},o,s))}catch{return!1}},K=async()=>{let t=await v();if(!t)return{};let e=q(),r=e?.[t]??{};if(C(r)){let o={[t]:A};return J(y({},e,o)),A}return r};a();n();var U=Z(st());a();n();et();a();n();rt();a();n();function nt(t){return async(e,r)=>{await e(p({...t,dates:c().stringDates,needMore:!0})),await e(w(!0));let o=r();e(R(P(o)))}}var d=j({name:"txHistory",initialState:{filters:{status:[1,2,3,4],dates:c().stringDates,mainCoinId:"",init:!0,needMore:!0},txList:[],initLoading:!0,scrollLoading:!1,filterLoading:!1,lastRowId:""},reducers:{setInitLoading:(t,e)=>{t.initLoading=e.payload},setScrollLoading:(t,e)=>{t.scrollLoading=e.payload},setFilterLoading:(t,e)=>{t.filterLoading=e.payload},setFilters:(t,e)=>{t.filters={...t.filters,...e.payload,init:!1}},setLastRowId:(t,e)=>{t.lastRowId=e.payload},setTxList:(t,e)=>{t.txList=e.payload},mergeTxList:(t,e)=>{t.txList=[...t.txList,...e.payload]},resetFilters(t){t.filters={status:[1,2,3,4],dates:c().stringDates,mainCoinId:"",init:!0,needMore:!0}},resetTxHistory:t=>{t.txList=[],t.initLoading=!1,t.scrollLoading=!1,t.filterLoading=!1,t.lastRowId=""}}}),{actions:it,reducer:lt}=d,Vt=lt,Tt=t=>t[d.name].txList,D=t=>t[d.name].filters,P=t=>{let e=D(t),{dates:[r,o],mainCoinId:s}=e;return{startDate:new Date(`${r} 00:00:00`).getTime(),endDate:new Date(`${o} 23:59:59`).getTime(),mainCoinId:s,status:[1,2,3,4]}},Y=t=>t[d.name].initLoading,$=t=>t[d.name].scrollLoading,b=t=>t[d.name].lastRowId,Mt=t=>t[d.name].filterLoading,{setFilters:p,setTxList:S,mergeTxList:F,setInitLoading:V,setScrollLoading:I,setFilterLoading:w,resetTxHistory:ht,setLastRowId:f,resetFilters:Ct}=it;var k=({scrollLoad:t,lastRowId:e,scrollLoading:r,initLoading:o,needMore:s,fromCoinDetail:i})=>!(t&&((i?!e:!e&&!s)||r||o)),B=(t,{needMore:e,fromCoinDetail:r,hasViewMore:o,rowId:s})=>{e&&!r&&!o&&(t(p({dates:c(N.subtract(180,"d"))?.stringDates,needMore:!1})),t(f(s)))},G=async(t,{reqParams:e,lastRowId:r,scrollLoad:o,fromCoinDetail:s})=>{if(o&&(t(I(!0)),e.lastRowId=r),!s)try{let i=await K();e.hideValuelessNft=i?.hideValuelessNft??!0}catch(i){console.error(i)}return e};var R=(t,e={initLoad:!1,scrollLoad:!1,autoRefresh:!1,fromCoinDetail:!1})=>async(r,o)=>{let s={...t},{initLoad:i,scrollLoad:u,fromCoinDetail:g}=e,_=g?O:H,L=o(),T=b(L),{needMore:M}=D(L),z=Y(L),Q=$(L);if(!!k({scrollLoad:u,lastRowId:T,scrollLoading:Q,initLoading:z,needMore:M,fromCoinDetail:g})){i&&(r(V(!0)),r(f(""))),await G(r,{reqParams:s,lastRowId:T,scrollLoad:u,fromCoinDetail:g});try{let m=await _(s),l=m?.content;(0,U.isEmpty)(l)&&(l=[]),r(u?F(l):S(l));let h=l.length,X=m.hasViewMore?l[h-1]?.rowId:"";r(f(X)),B(r,{needMore:M,fromCoinDetail:g,hasViewMore:m.hasViewMore,rowId:l[h-1]?.rowId})}catch{r(u?F([]):S([]))}i&&r(V(!1)),u&&r(I(!1)),r(w(!1))}};export{at as a,ft as b,gt as c,K as d,R as e,nt as f,Vt as g,Tt as h,D as i,P as j,Y as k,$ as l,b as m,Mt as n,p as o,S as p,V as q,ht as r,f as s,Ct as t};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-IV6GJDJI.js.map
